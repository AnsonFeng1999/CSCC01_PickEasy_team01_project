<!--                                          ----
----    coupon.html contains all frontend     ----
----     html for the owners view of the      ----
----               coupon page                ----
----                                          --->

{% extends "base.html" %}
{% block style %}
<link rel="stylesheet" type="text/css" href="static/coupon.css">
{% if session["type"] == 1 %}
<link rel="stylesheet" type="text/css" href="static/sidebar.css">
{% endif %}
{% endblock style %}
{% block title %}
<title>My Coupons</title>
{% endblock title %}

{% block coupon %}_pressed{% endblock coupon %}
{% block coupon2 %}_pressed{% endblock coupon2 %}

{% block sidebar %}
{% if session['type'] == 1 %}
<div class="sidenav">
  <div class = side_title>
    Coupons
  </div>
  <a href="coupon.html">
    <div class = but>
      <button type="button">
        <img src="static/Resources/coupon_pressed.png" alt="Coupon" class = coupon>
        My Coupons
      </button>
    </div>
  </a>
  {% if session['type'] == 1 %}
  <a href="createCoupon.html">
    <div class = but>
      <button type="button">
        <img src="static/Resources/plus.png" alt="Coupon">
        Create A Coupon
      </button>
    </div>
  </a>
  <a href="viewUserCoupons.html">
    <div class = but>
      <button type="button">
        <img src="static/Resources/eye.png" alt="Coupon">
        View Redeemed Coupons
      </button>
    </div>
  </a>
  {% endif %}
</div>
{% endif %}
{% endblock sidebar %}

{% block page_name %}
    <div class = parent>
      <div class = title>
        <div class = text>
          My Coupons
        </div>
        {% if session['type'] == 1 %}
        <div class = plus>
          <a href="createCoupon.html">+</a>
        </div>
        {% endif %}
      </div>
    </div>
{% endblock page_name %}

{% block content %}
    {% for c in coupons %}
    {% if session['type'] == -1 or  c['deleted'] == 0 %}
      <div class = parent>
        <div class = title>
          <div class = name>
            {{ c["name"] }}
            {{ c["cname"] }}
          </div>

            <!-- The gear for deleting coupons, only visable to owners -->
            {% if session['type'] == 1 %}
            <div class = settings_dropdown>
              <button class = settings><img src="static/Resources/gear.png" alt="Settings"></button>
              <div class = options>
                <form method = "post">
                  <input type="submit" value = "Delete" name = {{c["name"]}}>
                  <input type="hidden" value = {{c["cid"]}} name = coupon>
                </form>
              </div>
            </div>
            {% elif session['type'] == -1 %}
              <div class = right_container>
                {{ c["rname"] }}, at {{c["raddress"]}}
              </div>
            {% endif %}


          </div>
          {% if session['type'] == 1 %}
            <div class = amount>
              {{ c["points"] }} Points
            </div>
          {% endif %}
          <div class = description>
            {{ c["description"] }}
            {{ c["cdescription"] }}
          </div>

          <div class = footer>
            <div class = expiration>
              {% if c["begin"] == None or c["expiration"] == None %}
                Valid indefinitely
              {% else %}
                Valid from: {{ c["begin"] }} to {{ c["expiration"] }}
              {% endif %}
            </div>
            {% if session['type'] == -1 %}
            <div class = use_button>
              <form method = "post">
                <input type="submit" value = "Use" name = {{c["name"]}}>
                <input type="hidden" value = {{c["cid"]}} name = coupon>
              </form>
            </div>
            {% endif %}
          </div>
        </div>
      </div>
      {% endif %}
    {% endfor %}
  {% endblock content %}

  {% block script %} <script type="text/javascript" src = "static/coupons.js"></script>{% endblock script %}
