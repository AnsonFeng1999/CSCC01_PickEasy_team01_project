{% extends "base.html" %}

{% block title %}
<title>{{ rname }}</title>
{% endblock title %}

{% block style %}
<link rel="stylesheet" type="text/css" href="static/sidebar.css">
<link rel="stylesheet" type="text/css" href="static/submissionFields.css">
<link rel="stylesheet" type="text/css" href="static/restaurant.css">
<link rel="stylesheet" type="text/css" href="static/coupon.css">
{% endblock style %}

{% block sidebar %}
<div class="sidenav">
  <div class = side_title>
    {{ rname }}
  </div>
  <a href="restaurant{{ rid }}">
    <div class = but>
      <button type="button">
        <img src="static/Resources/home_pressed.png" alt="Coupon">
        Home
      </button>
    </div>
  </a>
  <a href="couponOffers{{ rid }}">
    <div class = but>
      <button type="button">
        <img src="static/Resources/coupon_pressed.png" alt="Coupon" class = coupon>
        Coupon Offers
      </button>
    </div>
  </a>
  <a href="availableAchievements{{ rid }}">
    <div class = but>
      <button type="button">
        <img src="static/Resources/achievement_pressed.png" alt="Achievement">
        Achievement Offers
      </button>
    </div>
  </a>
  <a href="leaderBoard{{ rid }}">
    <div class = but>
      <button type="button">
        <img src="static/Resources/leaderboard.png" alt="Achievement">
        Leader Board
      </button>
    </div>
  </a>
</div>
{% endblock sidebar %}

{% block page_name %}
    <div class = parent>
      <div class = title>
        <div class = text>
          Coupon Offers
        </div>
        <div class = total_points>
          My Points:&nbsp;
          <div class = pink>{{ points }}</div>
        </div>
      </div>
    </div>
{% endblock page_name %}

{% block content %}
{% if bought %}
  <div class = parent>
    <div class = message>
      The coupon <b>{{ bought }}</b> was successfully purchased, you can view your new coupon on your <b><a href="coupon.html">My Coupons page.</a></b>
    </div>
  </div>
{% endif %}

{% if errmsg %}
  <div class = parent>
    {% for msg in errmsg %}
      {{msg}}
    {% endfor %}
  </div>
{% endif %}

  {% for c in coupons %}
    <div class = parent>
      <div class = title>
        <div class = name>
          {{ c["name"] }}
        </div>
      </div>
      <div class = amount>
        {{ c["points"] }} Points
      </div>
      <div class = description>
        {{ c["description"] }}
      </div>
      <div class = expiration>
        {% if c["begin"] == None or c["expiration"] == None %}
          Valid indefinitely
        {% else %}
          Valid from: {{ c["begin"] }} to {{ c["expiration"] }}
        {% endif %}
      </div>

      {% if c["points"] > points %}
        <div class = toPoor>
          <input type="submit" value="Purchase">
        </div>
        <div class = fine_print>
          You do not have enough points for this coupon
        </div>
      {% else %}
      <form method = "post">
        <div class = submit_button>
            <input type="hidden" name = "cid" value = {{c['cid']}}>
            <input type="submit" value="Purchase">
        </div>
      </form>
      {% endif %}
    </div>
  {% endfor %}
{% endblock content %}
